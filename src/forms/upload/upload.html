<div class="droppable" ng-class="{
  'droppable-sm': $ctrl.size ==='sm',
  'droppable-md': $ctrl.size ==='md' || !$ctrl.size,
  'droppable-lg': $ctrl.size ==='lg',
  'droppable-dropping': $ctrl.isDroppable,
  'droppable-processing': !$ctrl.isDone && ($ctrl.isProcessing || $ctrl.isSuccess || $ctrl.isError),
  'droppable-complete': $ctrl.isDone
}">
  <div class="droppable-default-card" aria-hidden="{{$ctrl.isDone}}">
    <div ng-hide="$ctrl.showVideoPreview" class="droppable-card-content">
      <!-- Display illustration as image or icon -->
      <div class="m-b-2">
        <img
          ng-show="$ctrl.helpImage"
          ng-src="{{$ctrl.helpImage}}"
          alt="{{$ctrl.label}}"
          class="thumbnail text-xs-center" />
        <span ng-show="!$ctrl.helpImage" class="icon icon-{{$ctrl.viewIcon}} icon-xxl"></span>
      </div>
      <!-- helper texts -->
      <h4 class="m-b-1" ng-if="$ctrl.label || $ctrl.description">
        {{$ctrl.label || $ctrl.description}}
      </h4>
      <!-- upload action -->
      <p class="m-b-2">{{$ctrl.placeholder || $ctrl.instructions}}</p>

      <!-- regular upload -->
      <label class="btn btn-primary" ng-click="$ctrl.onUploadButtonClick()" ng-class="{'disabled': $ctrl.ngDisabled}">
        <span ng-if="$ctrl.buttonText" ng-bind="$ctrl.buttonText"></span>
        <span ng-if="!$ctrl.buttonText" class="icon icon-upload m-r-0"></span>
        <!-- normal upload -->
        <input
          ng-if="!$ctrl.isLiveCameraUpload"
          tw-file-input
          type="file"
          accept="{{$ctrl.accept}}"
          class="tw-droppable-input hidden"
          ng-disabled="$ctrl.ngDisabled"
          name="file-upload"
          on-user-input="$ctrl.onManualUpload()"
          ng-model="$ctrl.inputFile" />
      </label>

      <!-- camera only upload -->
      <tw-camera-capture
        ng-if="$ctrl.isLiveCameraUpload && $ctrl.showLiveCaptureScreen"
        overlay="{{$ctrl.cameraOverlay}}"
        direction="{{$ctrl.cameraDirection}}"
        on-cancel="$ctrl.onCameraCaptureCancel()"
        on-confirm="$ctrl.onCameraCaptureConfirm(file)">
      </tw-camera-capture>
    </div>
  </div>

  <div class="droppable-processing-card droppable-card" aria-hidden="{{$ctrl.isDone}}">
    <div class="droppable-card-content">
      <h4 class="m-b-2" ng-if="!$ctrl.uploadingText">
        <span ng-if="$ctrl.isProcessing && $ctrl.processingText" class="upload-processing-message">{{$ctrl.processingText}}</span>
        <span ng-if="$ctrl.isSuccess && $ctrl.successText" class="upload-success-message">{{$ctrl.successText}}</span>
        <span ng-if="$ctrl.isError && $ctrl.failureText" class="upload-failure-message">{{$ctrl.failureText}}</span>
      </h4>
      <tw-process size="sm" state="$ctrl.processingState"
        ng-if="($ctrl.isProcessing || $ctrl.isSuccess || $ctrl.isError)"></tw-process>
      <h4 ng-if="$ctrl.uploadingText" class="p-t-3">
        <span class="uploading-message">{{$ctrl.uploadingText}}</span>
      </h4>
    </div>
  </div>
  <div class="droppable-complete-card droppable-card" aria-hidden="{{!$ctrl.isDone}}" ng-class="{'transparent-area p-x-3': $ctrl.isImage && ($ctrl.successMessage || $ctrl.errorMessage) }">
  <div class="droppable-card-content">
      <div ng-if="!$ctrl.hasTranscluded && !$ctrl.isError && !$ctrl.successMessage">
        <h4 class="m-b-2" ng-if="$ctrl.label">
          {{$ctrl.label}}
        </h4>
        <img
          ng-if="$ctrl.isImage"
          src="data:image/png;base64,
            iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="
          ng-src="{{$ctrl.image}}"
          alt="OK"
          class="thumbnail m-b-3" />
        <span class="icon icon-pdf icon-xxl" ng-if="!$ctrl.isImage"></span>
        <p class="text-ellipsis m-b-2">{{$ctrl.fileName}}</p>
      </div>
      <div ng-if="!$ctrl.hasTranscluded && !$ctrl.isError && $ctrl.successMessage && $ctrl.isImage" ng-style="{'background': 'linear-gradient(rgba(250, 250, 250, 0.9), rgba(250, 250, 250, 0.9)), url({{ $ctrl.image }}) no-repeat center', 'background-size':'contain'}">
        <div class="m-b-3">
          <span class="icon-circle-shadow icon-md">
            <svg height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M6.92 20.06L0 13.32L0.7 12.6L6.92 18.66L23 3L23.7 3.72L6.92 20.06Z" fill="#2ED06E"/>
            </svg>
          </span>
        </div>
        <h4 class="m-b-2" ng-if="$ctrl.successMessage">
          {{$ctrl.successMessage}}
        </h4>
        <span class="icon icon-pdf icon-xxl" ng-if="!$ctrl.isImage"></span>
        <p class="m-b-2">{{$ctrl.successDetails}}</p>
      </div>
      <div ng-if="!$ctrl.hasTranscluded && $ctrl.isError && !$ctrl.errorMessage">
        <h4 class="m-b-2" ng-if="$ctrl.isTooLarge">{{$ctrl.tooLargeMessage}}</h4>
        <h4 class="m-b-2" ng-if="$ctrl.isWrongType">{{$ctrl.wrongTypeText}}</h4>
        <h4 class="m-b-2" ng-if="!$ctrl.isTooLarge && $ctrl.errorMessage">{{$ctrl.errorMessage}}</h4>
        <span class="icon icon-alert icon-xxl text-danger m-b-1"></span>
      </div>
      <div ng-if="!$ctrl.hasTranscluded && $ctrl.isError && $ctrl.errorMessage && $ctrl.isImage" ng-style="{'background': 'linear-gradient(rgba(250, 250, 250, 0.9), rgba(250, 250, 250, 0.9)), url({{ $ctrl.image }}) no-repeat center', 'background-size':'contain'}">
        <div class="m-b-3 hidden-md hidden-sm hidden-xs"><span class="icon icon-alert icon-circle-shadow icon-md"></span></div>
        <h5 class="m-b-2" ng-if="$ctrl.errorMessage">{{$ctrl.errorMessage}}</h5>
        <div class="m-b-3">
          <p ng-if="$ctrl.firstError">{{$ctrl.firstError.message}}</p>
        </div>
        <div class="btn-group-vertical btn-block">
          <label class="btn btn-primary btn-sm m-b-1" ng-click="$ctrl.onUploadButtonClick()" ng-class="{'disabled': $ctrl.ngDisabled}" ng-if="!$ctrl.isLiveCameraUpload">
              <span ng-if="$ctrl.buttonText" ng-bind="$ctrl.cancelText"></span>
              <!-- normal upload -->
              <input
                
                tw-file-input
                type="file"
                accept="{{$ctrl.accept}}"
                class="tw-droppable-input-reupload hidden"
                ng-disabled="$ctrl.ngDisabled"
                name="file-upload"
                on-user-input="$ctrl.onManualReupload()"
                ng-model="$ctrl.inputFile" />
            </label>
          <div class="btn btn-primary btn-sm m-b-1" ng-click="$ctrl.clear()" ng-if="$ctrl.isLiveCameraUpload">{{$ctrl.cancelText}}</div>
          <div ng-if="$ctrl.viewImageText" ng-click="$ctrl.toggleImageModal()" class="btn btn-info btn-sm">{{$ctrl.viewImageText}}</div>
        </div>
      </div>
      <div ng-if="$ctrl.hasTranscluded" ng-transclude></div>
      <p class="m-t-2 m-b-0" ng-if="!$ctrl.successMessage && !$ctrl.errorMessage">
        <a href="" ng-click="$ctrl.clear()">
          <!-- Draw a happy little cross in a happy little circle (X) -->
          <svg
            ng-if="!$ctrl.cancelText"
            viewBox="0 0 24 24"
            fill="#00b9ff"
            xmlns="http://www.w3.org/2000/svg"
            height="25">
            <path d="M12 23a11 11 0 1 1 11-11 11 11 0 0 1-11 11zm0-21a10 10 0 1 0 10 10A10 10 0 0 0 12 2z"></path>
            <path
              d="M16.85 7.85l-.71-.7L12 11.29 7.85 7.15l-.71.7L11.29 12l-4.15 4.15.71.7L12 12.71l4.14 4.14.71-.7L12.7 12l4.15-4.15z">
            </path>
          </svg>
          {{$ctrl.cancelText}}
        </a>
      </p>
    </div>
  </div>

  <div class="droppable-dropping-card droppable-card">
    <div class="droppable-card-content">
      <h4 class="m-b-2">Drop file to start upload</h4>
      <div class="circle circle-sm">
        <span class="icon icon-add"></span>
      </div>
      <p class="m-t-2 m-b-0"></p>
    </div>
  </div>
</div>

<tw-image-details-modal
  title="$ctrl.errorMessage"
  messages="$ctrl.errorReasons"
  visibility="$ctrl.showModal"
  image="$ctrl.image"
  toggle-modal="$ctrl.toggleImageModal()"
>
</tw-image-details-modal>
