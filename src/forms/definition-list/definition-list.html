<div class="m-t-1">
  <h4
    ng-if="$ctrl.legend"
    ng-bind="$ctrl.legend"
    class="page-header p-t-3">
  </h4>
</div>
<div class="row row-equal-height">
  <div class="col-xs-12"
    ng-class="{'col-sm-6': !$ctrl.narrow}"
    ng-repeat="field in $ctrl.fields track by $index"
    ng-if="$ctrl.model[field.key] || $ctrl.model[field.group[0].key]">

    <dl ng-if="!field.group">
      <dt ng-bind="field.name"></dt>
      <dd ng-switch="field.type">
        <span ng-switch-when="select|radio" ng-switch-when-separator="|">
          {{ $ctrl.getValueLabel(field.valuesAllowed, $ctrl.model[field.key]) }}
        </span>
        <span ng-switch-when="date">
          {{ $ctrl.model[field.key] | twDateFormat: $ctrl.locale }}
        </span>
        <span ng-switch-when="password">
          {{ $ctrl.mask($ctrl.model[field.key]) }}
        </span>
        <div ng-switch-when="upload" class="thumbnail">
          <img alt="{{ field.name }}"
            ng-src="{{ $ctrl.model[field.key] }}"
            ng-attr-alt="{{ field.name }}" />
        </div>
        <span ng-switch-default>
          {{ $ctrl.model[field.key] | twTextFormat: field.displayFormat }}
        </span>
      </dd>
    </dl>

    <!-- Start old 'nested group' style -->
    <dl ng-if="field.group">
      <dt ng-bind="field.name"></dt>
      <dd>
        <span ng-repeat="fieldSection in field.group">
          <span ng-switch="field.type">
            <span ng-switch-when="select|radio" ng-switch-when-separator="|">
              {{ $ctrl.getValueLabel(fieldSection.valuesAllowed, $ctrl.model[fieldSection.key]) }}
            </span>
            <span ng-switch-when="date">
              {{ $ctrl.model[fieldSection.key] | twDateFormat: $ctrl.locale }}
            </span>
            <span ng-switch-when="password">
              {{ $ctrl.mask($ctrl.model[fieldSection.key]) }}
            </span>
            <div ng-switch-when="upload" class="thumbnail">
              <img alt="{{ field.name }}"
                ng-src="{{ $ctrl.model[fieldSection.key] }}"
                ng-attr-alt="{{ field.name }}" />
            </div>
            <span ng-switch-default>
              {{ $ctrl.model[fieldSection.key] | twTextFormat: fieldSection.displayFormat }}
            </span>
          </span>
        </span>
      </dd>
    </dl>
    <!-- End old 'nested group' style -->

  </div>
</div>
